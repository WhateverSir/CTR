2023-06-14 10:16:27,981 P23559 INFO Start the demo...
2023-06-14 10:16:27,982 P23559 INFO {
    "model_id": "DeepFM",
    "dataset_id": "ml1m-20230614-101627",
    "train_data": "../data/Movielens1M/Movielens1M_x0/train.csv",
    "valid_data": "../data/Movielens1M/Movielens1M_x0/test.csv",
    "test_data": "../data/Movielens1M/Movielens1M_x0/test.csv",
    "model_dir": "../checkpoints/",
    "embedding_dim": "64",
    "embedding_regularizer": "0.01",
    "kernel_regularizer": "0",
    "hidden_units": "[500, 500, 500, 500]",
    "hidden_activations": "relu",
    "learning_rate": "0.001",
    "dropout_rates": "0",
    "batch_norm": "False",
    "optimizer": "adam",
    "task": "classification",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "10",
    "batch_size": "10000",
    "epochs": "50",
    "shuffle": "True",
    "seed": "2019",
    "monitor": "AUC",
    "monitor_mode": "max",
    "use_hdf5": "True",
    "patience": "2",
    "workers": "1",
    "verbose": "0",
    "version": "pytorch",
    "gpu": "0"
}
2023-06-14 10:16:27,982 P23559 INFO Set up feature encoder...
2023-06-14 10:16:27,982 P23559 INFO Reading file: ../data/Movielens1M/Movielens1M_x0/train.csv
2023-06-14 10:16:28,339 P23559 INFO Preprocess feature columns...
2023-06-14 10:16:28,486 P23559 INFO Fit feature encoder...
2023-06-14 10:16:28,782 P23559 INFO Setting feature index.
2023-06-14 10:16:28,783 P23559 INFO Set feature encoder done.
2023-06-14 10:16:28,785 P23559 INFO Pickle feature encode to file: ../checkpoints/ml1m-20230614-101627/feature_encoder.pkl
2023-06-14 10:16:28,792 P23559 INFO Loading data...
2023-06-14 10:16:28,793 P23559 INFO Reading file: ../data/Movielens1M/Movielens1M_x0/train.csv
2023-06-14 10:16:29,135 P23559 INFO Preprocess feature columns...
2023-06-14 10:16:29,265 P23559 INFO Transform feature encoder...
2023-06-14 10:16:29,732 P23559 INFO Saving data to ../checkpoints/ml1m-20230614-101627/train.hdf5
2023-06-14 10:16:29,763 P23559 INFO Reading file: ../data/Movielens1M/Movielens1M_x0/test.csv
2023-06-14 10:16:29,849 P23559 INFO Preprocess feature columns...
2023-06-14 10:16:29,883 P23559 INFO Transform feature encoder...
2023-06-14 10:16:29,982 P23559 INFO Saving data to ../checkpoints/ml1m-20230614-101627/test.hdf5
2023-06-14 10:16:29,995 P23559 INFO Train samples: total/589667 pos/466606 neg/123061 ratio/79.13%
2023-06-14 10:16:29,996 P23559 INFO Validation samples: total/147386 pos/107650 neg/39736 ratio/73.04%
2023-06-14 10:16:29,996 P23559 INFO Loading data from ../checkpoints/ml1m-20230614-101627/test.hdf5
2023-06-14 10:16:30,000 P23559 INFO Test samples: total/147386 pos/107650 neg/39736 ratio/73.04%
2023-06-14 10:16:30,000 P23559 INFO Loading data done.
2023-06-14 10:16:30,045 P23559 INFO **** Start training: 59 batches/epoch ****
2023-06-14 10:16:37,854 P23559 INFO [Metrics] logloss: 0.441860 - AUC: 0.836985
2023-06-14 10:16:37,856 P23559 INFO Save best model: monitor(max): 0.836985
2023-06-14 10:16:37,863 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:16:37,998 P23559 INFO Train loss: 0.458641
2023-06-14 10:16:37,998 P23559 INFO ************ Epoch=1 end ************
2023-06-14 10:16:46,952 P23559 INFO [Metrics] logloss: 0.404435 - AUC: 0.852785
2023-06-14 10:16:46,954 P23559 INFO Save best model: monitor(max): 0.852785
2023-06-14 10:16:46,963 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:16:47,124 P23559 INFO Train loss: 0.389086
2023-06-14 10:16:47,124 P23559 INFO ************ Epoch=2 end ************
2023-06-14 10:16:55,872 P23559 INFO [Metrics] logloss: 0.395360 - AUC: 0.860630
2023-06-14 10:16:55,874 P23559 INFO Save best model: monitor(max): 0.860630
2023-06-14 10:16:55,883 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:16:56,064 P23559 INFO Train loss: 0.377055
2023-06-14 10:16:56,065 P23559 INFO ************ Epoch=3 end ************
2023-06-14 10:17:04,938 P23559 INFO [Metrics] logloss: 0.387359 - AUC: 0.866524
2023-06-14 10:17:04,940 P23559 INFO Save best model: monitor(max): 0.866524
2023-06-14 10:17:04,949 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:17:05,126 P23559 INFO Train loss: 0.372056
2023-06-14 10:17:05,127 P23559 INFO ************ Epoch=4 end ************
2023-06-14 10:17:13,473 P23559 INFO [Metrics] logloss: 0.384418 - AUC: 0.872193
2023-06-14 10:17:13,475 P23559 INFO Save best model: monitor(max): 0.872193
2023-06-14 10:17:13,484 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:17:13,659 P23559 INFO Train loss: 0.366438
2023-06-14 10:17:13,659 P23559 INFO ************ Epoch=5 end ************
2023-06-14 10:17:22,271 P23559 INFO [Metrics] logloss: 0.380855 - AUC: 0.873341
2023-06-14 10:17:22,273 P23559 INFO Save best model: monitor(max): 0.873341
2023-06-14 10:17:22,282 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:17:22,494 P23559 INFO Train loss: 0.362629
2023-06-14 10:17:22,494 P23559 INFO ************ Epoch=6 end ************
2023-06-14 10:17:31,011 P23559 INFO [Metrics] logloss: 0.375422 - AUC: 0.876161
2023-06-14 10:17:31,014 P23559 INFO Save best model: monitor(max): 0.876161
2023-06-14 10:17:31,023 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:17:31,270 P23559 INFO Train loss: 0.359458
2023-06-14 10:17:31,271 P23559 INFO ************ Epoch=7 end ************
2023-06-14 10:17:40,767 P23559 INFO [Metrics] logloss: 0.372981 - AUC: 0.877818
2023-06-14 10:17:40,769 P23559 INFO Save best model: monitor(max): 0.877818
2023-06-14 10:17:40,778 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:17:40,968 P23559 INFO Train loss: 0.354794
2023-06-14 10:17:40,969 P23559 INFO ************ Epoch=8 end ************
2023-06-14 10:17:50,039 P23559 INFO [Metrics] logloss: 0.370397 - AUC: 0.880069
2023-06-14 10:17:50,042 P23559 INFO Save best model: monitor(max): 0.880069
2023-06-14 10:17:50,051 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:17:50,217 P23559 INFO Train loss: 0.352368
2023-06-14 10:17:50,217 P23559 INFO ************ Epoch=9 end ************
2023-06-14 10:17:59,023 P23559 INFO [Metrics] logloss: 0.367611 - AUC: 0.881396
2023-06-14 10:17:59,025 P23559 INFO Save best model: monitor(max): 0.881396
2023-06-14 10:17:59,034 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:17:59,196 P23559 INFO Train loss: 0.350533
2023-06-14 10:17:59,196 P23559 INFO ************ Epoch=10 end ************
2023-06-14 10:18:08,240 P23559 INFO [Metrics] logloss: 0.366890 - AUC: 0.881761
2023-06-14 10:18:08,242 P23559 INFO Save best model: monitor(max): 0.881761
2023-06-14 10:18:08,251 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:18:08,416 P23559 INFO Train loss: 0.349311
2023-06-14 10:18:08,416 P23559 INFO ************ Epoch=11 end ************
2023-06-14 10:18:17,249 P23559 INFO [Metrics] logloss: 0.366594 - AUC: 0.882647
2023-06-14 10:18:17,252 P23559 INFO Save best model: monitor(max): 0.882647
2023-06-14 10:18:17,261 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:18:17,438 P23559 INFO Train loss: 0.346858
2023-06-14 10:18:17,438 P23559 INFO ************ Epoch=12 end ************
2023-06-14 10:18:26,956 P23559 INFO [Metrics] logloss: 0.366268 - AUC: 0.883369
2023-06-14 10:18:26,958 P23559 INFO Save best model: monitor(max): 0.883369
2023-06-14 10:18:26,967 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:18:27,133 P23559 INFO Train loss: 0.345190
2023-06-14 10:18:27,133 P23559 INFO ************ Epoch=13 end ************
2023-06-14 10:18:36,263 P23559 INFO [Metrics] logloss: 0.364084 - AUC: 0.884181
2023-06-14 10:18:36,265 P23559 INFO Save best model: monitor(max): 0.884181
2023-06-14 10:18:36,274 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:18:36,442 P23559 INFO Train loss: 0.343706
2023-06-14 10:18:36,442 P23559 INFO ************ Epoch=14 end ************
2023-06-14 10:18:45,126 P23559 INFO [Metrics] logloss: 0.362665 - AUC: 0.884764
2023-06-14 10:18:45,128 P23559 INFO Save best model: monitor(max): 0.884764
2023-06-14 10:18:45,137 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:18:45,318 P23559 INFO Train loss: 0.340942
2023-06-14 10:18:45,319 P23559 INFO ************ Epoch=15 end ************
2023-06-14 10:18:54,293 P23559 INFO [Metrics] logloss: 0.364194 - AUC: 0.885059
2023-06-14 10:18:54,295 P23559 INFO Save best model: monitor(max): 0.885059
2023-06-14 10:18:54,304 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:18:54,481 P23559 INFO Train loss: 0.340394
2023-06-14 10:18:54,481 P23559 INFO ************ Epoch=16 end ************
2023-06-14 10:19:03,435 P23559 INFO [Metrics] logloss: 0.365333 - AUC: 0.884508
2023-06-14 10:19:03,437 P23559 INFO Monitor(max) STOP: 0.884508 !
2023-06-14 10:19:03,437 P23559 INFO Reduce learning rate on plateau: 0.000100
2023-06-14 10:19:03,437 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:19:03,661 P23559 INFO Train loss: 0.337901
2023-06-14 10:19:03,661 P23559 INFO ************ Epoch=17 end ************
2023-06-14 10:19:13,046 P23559 INFO [Metrics] logloss: 0.360230 - AUC: 0.889892
2023-06-14 10:19:13,048 P23559 INFO Save best model: monitor(max): 0.889892
2023-06-14 10:19:13,057 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:19:13,245 P23559 INFO Train loss: 0.307147
2023-06-14 10:19:13,245 P23559 INFO ************ Epoch=18 end ************
2023-06-14 10:19:22,173 P23559 INFO [Metrics] logloss: 0.360934 - AUC: 0.890806
2023-06-14 10:19:22,175 P23559 INFO Save best model: monitor(max): 0.890806
2023-06-14 10:19:22,184 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:19:22,347 P23559 INFO Train loss: 0.291292
2023-06-14 10:19:22,348 P23559 INFO ************ Epoch=19 end ************
2023-06-14 10:19:31,521 P23559 INFO [Metrics] logloss: 0.362254 - AUC: 0.889795
2023-06-14 10:19:31,523 P23559 INFO Monitor(max) STOP: 0.889795 !
2023-06-14 10:19:31,523 P23559 INFO Reduce learning rate on plateau: 0.000010
2023-06-14 10:19:31,523 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:19:31,682 P23559 INFO Train loss: 0.283499
2023-06-14 10:19:31,683 P23559 INFO ************ Epoch=20 end ************
2023-06-14 10:19:40,814 P23559 INFO [Metrics] logloss: 0.368506 - AUC: 0.889843
2023-06-14 10:19:40,816 P23559 INFO Monitor(max) STOP: 0.889843 !
2023-06-14 10:19:40,816 P23559 INFO Reduce learning rate on plateau: 0.000001
2023-06-14 10:19:40,816 P23559 INFO Early stopping at epoch=20.98
2023-06-14 10:19:40,816 P23559 INFO --- 59/59 batches finished ---
2023-06-14 10:19:40,874 P23559 INFO Train loss: 0.265797
2023-06-14 10:19:40,874 P23559 INFO Training finished.
2023-06-14 10:19:40,874 P23559 INFO Load best model: /workspace/sophon-demo/sample/CTR/checkpoints/ml1m-20230614-101627/DeepFM_ml1m-20230614-101627_model.ckpt
2023-06-14 10:19:40,902 P23559 INFO ***** Train/validation/test results *****
2023-06-14 10:19:45,845 P23559 INFO [Metrics] logloss: 0.251423 - AUC: 0.933343
2023-06-14 10:19:47,329 P23559 INFO [Metrics] logloss: 0.360934 - AUC: 0.890806
2023-06-14 10:19:48,773 P23559 INFO [Metrics] logloss: 0.360934 - AUC: 0.890806
2023-06-14 10:28:10,062 P30315 INFO Start the demo...
2023-06-14 10:28:10,062 P30315 INFO {
    "model_id": "DeepFM",
    "dataset_id": "ml1m-20230614-101627",
    "train_data": "../data/Movielens1M/Movielens1M_x0/train.csv",
    "valid_data": "../data/Movielens1M/Movielens1M_x0/test.csv",
    "test_data": "../data/Movielens1M/Movielens1M_x0/test.csv",
    "model_dir": "../checkpoints/",
    "embedding_dim": "64",
    "embedding_regularizer": "0.01",
    "kernel_regularizer": "0",
    "hidden_units": "[500, 500, 500, 500]",
    "hidden_activations": "relu",
    "learning_rate": "0.001",
    "dropout_rates": "0",
    "batch_norm": "False",
    "optimizer": "adam",
    "task": "classification",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "10",
    "batch_size": "10000",
    "epochs": "50",
    "shuffle": "True",
    "seed": "2019",
    "monitor": "AUC",
    "monitor_mode": "max",
    "use_hdf5": "True",
    "patience": "2",
    "workers": "1",
    "verbose": "0",
    "version": "pytorch",
    "gpu": "0"
}
2023-06-14 10:28:10,062 P30315 INFO Set up feature encoder...
2023-06-14 10:28:10,063 P30315 INFO Reading file: ../data/Movielens1M/Movielens1M_x0/train.csv
2023-06-14 10:28:10,418 P30315 INFO Preprocess feature columns...
2023-06-14 10:28:10,566 P30315 INFO Fit feature encoder...
2023-06-14 10:28:10,875 P30315 INFO Setting feature index.
2023-06-14 10:28:10,875 P30315 INFO Set feature encoder done.
2023-06-14 10:28:58,203 P30412 INFO Start the demo...
2023-06-14 10:28:58,203 P30412 INFO {
    "model_id": "DeepFM",
    "dataset_id": "ml1m-20230614-101627",
    "train_data": "../data/Movielens1M/Movielens1M_x0/train.csv",
    "valid_data": "../data/Movielens1M/Movielens1M_x0/test.csv",
    "test_data": "../data/Movielens1M/Movielens1M_x0/test.csv",
    "model_dir": "../checkpoints/",
    "embedding_dim": "64",
    "embedding_regularizer": "0.01",
    "kernel_regularizer": "0",
    "hidden_units": "[500, 500, 500, 500]",
    "hidden_activations": "relu",
    "learning_rate": "0.001",
    "dropout_rates": "0",
    "batch_norm": "False",
    "optimizer": "adam",
    "task": "classification",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "10",
    "batch_size": "10000",
    "epochs": "50",
    "shuffle": "True",
    "seed": "2019",
    "monitor": "AUC",
    "monitor_mode": "max",
    "use_hdf5": "True",
    "patience": "2",
    "workers": "1",
    "verbose": "0",
    "version": "pytorch",
    "gpu": "0"
}
2023-06-14 10:28:58,204 P30412 INFO Set up feature encoder...
2023-06-14 10:28:58,204 P30412 INFO Reading file: ../data/Movielens1M/Movielens1M_x0/train.csv
2023-06-14 10:28:58,562 P30412 INFO Preprocess feature columns...
2023-06-14 10:28:58,712 P30412 INFO Fit feature encoder...
2023-06-14 10:28:59,022 P30412 INFO Setting feature index.
2023-06-14 10:28:59,023 P30412 INFO Set feature encoder done.
