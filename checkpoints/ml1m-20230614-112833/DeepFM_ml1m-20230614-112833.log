2023-06-14 11:28:33,951 P42753 INFO Start the demo...
2023-06-14 11:28:33,951 P42753 INFO {
    "model_id": "DeepFM",
    "dataset_id": "ml1m-20230614-112833",
    "train_data": "../data/Movielens1M/Movielens1M_x0/train.csv",
    "valid_data": "../data/Movielens1M/Movielens1M_x0/test.csv",
    "test_data": "../data/Movielens1M/Movielens1M_x0/test.csv",
    "model_dir": "../checkpoints/",
    "embedding_dim": "64",
    "embedding_regularizer": "0.01",
    "kernel_regularizer": "0",
    "hidden_units": "[500, 500, 500, 500]",
    "hidden_activations": "relu",
    "learning_rate": "0.001",
    "dropout_rates": "0",
    "batch_norm": "False",
    "optimizer": "adam",
    "task": "classification",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "10",
    "batch_size": "10000",
    "epochs": "50",
    "shuffle": "True",
    "seed": "2019",
    "monitor": "AUC",
    "monitor_mode": "max",
    "use_hdf5": "True",
    "patience": "2",
    "workers": "1",
    "verbose": "0",
    "version": "pytorch",
    "gpu": "0"
}
2023-06-14 11:28:33,952 P42753 INFO Set up feature encoder...
2023-06-14 11:28:33,952 P42753 INFO Reading file: ../data/Movielens1M/Movielens1M_x0/train.csv
2023-06-14 11:28:34,307 P42753 INFO Preprocess feature columns...
2023-06-14 11:28:34,454 P42753 INFO Fit feature encoder...
2023-06-14 11:28:34,752 P42753 INFO Setting feature index.
2023-06-14 11:28:34,753 P42753 INFO Set feature encoder done.
2023-06-14 11:28:34,755 P42753 INFO Pickle feature encode to file: ../checkpoints/ml1m-20230614-112833/feature_encoder.pkl
2023-06-14 11:28:34,763 P42753 INFO Loading data...
2023-06-14 11:28:34,763 P42753 INFO Reading file: ../data/Movielens1M/Movielens1M_x0/train.csv
2023-06-14 11:28:35,103 P42753 INFO Preprocess feature columns...
2023-06-14 11:28:35,233 P42753 INFO Transform feature encoder...
2023-06-14 11:28:35,700 P42753 INFO Saving data to ../checkpoints/ml1m-20230614-112833/train.hdf5
2023-06-14 11:28:35,733 P42753 INFO Reading file: ../data/Movielens1M/Movielens1M_x0/test.csv
2023-06-14 11:28:35,820 P42753 INFO Preprocess feature columns...
2023-06-14 11:28:35,854 P42753 INFO Transform feature encoder...
2023-06-14 11:28:35,952 P42753 INFO Saving data to ../checkpoints/ml1m-20230614-112833/test.hdf5
2023-06-14 11:28:35,965 P42753 INFO Train samples: total/589667 pos/466606 neg/123061 ratio/79.13%
2023-06-14 11:28:35,966 P42753 INFO Validation samples: total/147386 pos/107650 neg/39736 ratio/73.04%
2023-06-14 11:28:35,966 P42753 INFO Loading data from ../checkpoints/ml1m-20230614-112833/test.hdf5
2023-06-14 11:28:35,970 P42753 INFO Test samples: total/147386 pos/107650 neg/39736 ratio/73.04%
2023-06-14 11:28:35,970 P42753 INFO Loading data done.
2023-06-14 11:28:36,016 P42753 INFO **** Start training: 59 batches/epoch ****
2023-06-14 11:28:44,348 P42753 INFO [Metrics] logloss: 0.441860 - AUC: 0.836985
2023-06-14 11:28:44,350 P42753 INFO Save best model: monitor(max): 0.836985
2023-06-14 11:28:44,358 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:28:44,543 P42753 INFO Train loss: 0.458641
2023-06-14 11:28:44,543 P42753 INFO ************ Epoch=1 end ************
2023-06-14 11:28:53,482 P42753 INFO [Metrics] logloss: 0.404435 - AUC: 0.852785
2023-06-14 11:28:53,484 P42753 INFO Save best model: monitor(max): 0.852785
2023-06-14 11:28:53,493 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:28:53,695 P42753 INFO Train loss: 0.389086
2023-06-14 11:28:53,695 P42753 INFO ************ Epoch=2 end ************
2023-06-14 11:29:03,250 P42753 INFO [Metrics] logloss: 0.395360 - AUC: 0.860630
2023-06-14 11:29:03,252 P42753 INFO Save best model: monitor(max): 0.860630
2023-06-14 11:29:03,261 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:29:03,457 P42753 INFO Train loss: 0.377055
2023-06-14 11:29:03,457 P42753 INFO ************ Epoch=3 end ************
2023-06-14 11:29:12,922 P42753 INFO [Metrics] logloss: 0.387359 - AUC: 0.866524
2023-06-14 11:29:12,924 P42753 INFO Save best model: monitor(max): 0.866524
2023-06-14 11:29:12,933 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:29:13,090 P42753 INFO Train loss: 0.372056
2023-06-14 11:29:13,090 P42753 INFO ************ Epoch=4 end ************
2023-06-14 11:29:22,200 P42753 INFO [Metrics] logloss: 0.384418 - AUC: 0.872193
2023-06-14 11:29:22,202 P42753 INFO Save best model: monitor(max): 0.872193
2023-06-14 11:29:22,212 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:29:22,370 P42753 INFO Train loss: 0.366438
2023-06-14 11:29:22,370 P42753 INFO ************ Epoch=5 end ************
2023-06-14 11:29:31,592 P42753 INFO [Metrics] logloss: 0.380855 - AUC: 0.873341
2023-06-14 11:29:31,594 P42753 INFO Save best model: monitor(max): 0.873341
2023-06-14 11:29:31,603 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:29:31,765 P42753 INFO Train loss: 0.362629
2023-06-14 11:29:31,765 P42753 INFO ************ Epoch=6 end ************
2023-06-14 11:29:41,206 P42753 INFO [Metrics] logloss: 0.375422 - AUC: 0.876161
2023-06-14 11:29:41,208 P42753 INFO Save best model: monitor(max): 0.876161
2023-06-14 11:29:41,218 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:29:41,401 P42753 INFO Train loss: 0.359458
2023-06-14 11:29:41,401 P42753 INFO ************ Epoch=7 end ************
2023-06-14 11:29:50,721 P42753 INFO [Metrics] logloss: 0.372981 - AUC: 0.877818
2023-06-14 11:29:50,723 P42753 INFO Save best model: monitor(max): 0.877818
2023-06-14 11:29:50,732 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:29:50,990 P42753 INFO Train loss: 0.354794
2023-06-14 11:29:50,990 P42753 INFO ************ Epoch=8 end ************
2023-06-14 11:30:00,553 P42753 INFO [Metrics] logloss: 0.370397 - AUC: 0.880069
2023-06-14 11:30:00,555 P42753 INFO Save best model: monitor(max): 0.880069
2023-06-14 11:30:00,564 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:30:00,743 P42753 INFO Train loss: 0.352368
2023-06-14 11:30:00,744 P42753 INFO ************ Epoch=9 end ************
2023-06-14 11:30:09,623 P42753 INFO [Metrics] logloss: 0.367611 - AUC: 0.881396
2023-06-14 11:30:09,625 P42753 INFO Save best model: monitor(max): 0.881396
2023-06-14 11:30:09,634 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:30:09,896 P42753 INFO Train loss: 0.350533
2023-06-14 11:30:09,896 P42753 INFO ************ Epoch=10 end ************
2023-06-14 11:30:19,780 P42753 INFO [Metrics] logloss: 0.366890 - AUC: 0.881761
2023-06-14 11:30:19,782 P42753 INFO Save best model: monitor(max): 0.881761
2023-06-14 11:30:19,791 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:30:20,032 P42753 INFO Train loss: 0.349311
2023-06-14 11:30:20,032 P42753 INFO ************ Epoch=11 end ************
2023-06-14 11:30:29,771 P42753 INFO [Metrics] logloss: 0.366594 - AUC: 0.882647
2023-06-14 11:30:29,773 P42753 INFO Save best model: monitor(max): 0.882647
2023-06-14 11:30:29,782 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:30:29,937 P42753 INFO Train loss: 0.346858
2023-06-14 11:30:29,938 P42753 INFO ************ Epoch=12 end ************
2023-06-14 11:30:39,122 P42753 INFO [Metrics] logloss: 0.366268 - AUC: 0.883369
2023-06-14 11:30:39,124 P42753 INFO Save best model: monitor(max): 0.883369
2023-06-14 11:30:39,133 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:30:39,296 P42753 INFO Train loss: 0.345190
2023-06-14 11:30:39,296 P42753 INFO ************ Epoch=13 end ************
2023-06-14 11:30:48,779 P42753 INFO [Metrics] logloss: 0.364084 - AUC: 0.884181
2023-06-14 11:30:48,782 P42753 INFO Save best model: monitor(max): 0.884181
2023-06-14 11:30:48,791 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:30:48,957 P42753 INFO Train loss: 0.343706
2023-06-14 11:30:48,957 P42753 INFO ************ Epoch=14 end ************
2023-06-14 11:30:58,121 P42753 INFO [Metrics] logloss: 0.362665 - AUC: 0.884764
2023-06-14 11:30:58,123 P42753 INFO Save best model: monitor(max): 0.884764
2023-06-14 11:30:58,132 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:30:58,328 P42753 INFO Train loss: 0.340942
2023-06-14 11:30:58,328 P42753 INFO ************ Epoch=15 end ************
2023-06-14 11:31:07,452 P42753 INFO [Metrics] logloss: 0.364194 - AUC: 0.885059
2023-06-14 11:31:07,454 P42753 INFO Save best model: monitor(max): 0.885059
2023-06-14 11:31:07,463 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:31:07,693 P42753 INFO Train loss: 0.340394
2023-06-14 11:31:07,693 P42753 INFO ************ Epoch=16 end ************
2023-06-14 11:31:16,837 P42753 INFO [Metrics] logloss: 0.365333 - AUC: 0.884508
2023-06-14 11:31:16,839 P42753 INFO Monitor(max) STOP: 0.884508 !
2023-06-14 11:31:16,839 P42753 INFO Reduce learning rate on plateau: 0.000100
2023-06-14 11:31:16,839 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:31:17,015 P42753 INFO Train loss: 0.337901
2023-06-14 11:31:17,016 P42753 INFO ************ Epoch=17 end ************
2023-06-14 11:31:26,268 P42753 INFO [Metrics] logloss: 0.360230 - AUC: 0.889892
2023-06-14 11:31:26,270 P42753 INFO Save best model: monitor(max): 0.889892
2023-06-14 11:31:26,281 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:31:26,483 P42753 INFO Train loss: 0.307147
2023-06-14 11:31:26,483 P42753 INFO ************ Epoch=18 end ************
2023-06-14 11:31:35,822 P42753 INFO [Metrics] logloss: 0.360934 - AUC: 0.890806
2023-06-14 11:31:35,824 P42753 INFO Save best model: monitor(max): 0.890806
2023-06-14 11:31:35,834 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:31:36,014 P42753 INFO Train loss: 0.291292
2023-06-14 11:31:36,015 P42753 INFO ************ Epoch=19 end ************
2023-06-14 11:31:45,153 P42753 INFO [Metrics] logloss: 0.362254 - AUC: 0.889795
2023-06-14 11:31:45,155 P42753 INFO Monitor(max) STOP: 0.889795 !
2023-06-14 11:31:45,155 P42753 INFO Reduce learning rate on plateau: 0.000010
2023-06-14 11:31:45,155 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:31:45,447 P42753 INFO Train loss: 0.283499
2023-06-14 11:31:45,448 P42753 INFO ************ Epoch=20 end ************
2023-06-14 11:31:54,325 P42753 INFO [Metrics] logloss: 0.368506 - AUC: 0.889843
2023-06-14 11:31:54,327 P42753 INFO Monitor(max) STOP: 0.889843 !
2023-06-14 11:31:54,327 P42753 INFO Reduce learning rate on plateau: 0.000001
2023-06-14 11:31:54,327 P42753 INFO Early stopping at epoch=20.98
2023-06-14 11:31:54,327 P42753 INFO --- 59/59 batches finished ---
2023-06-14 11:31:54,379 P42753 INFO Train loss: 0.265797
2023-06-14 11:31:54,380 P42753 INFO Training finished.
2023-06-14 11:31:54,380 P42753 INFO Load best model: /workspace/sophon-demo/sample/CTR/checkpoints/ml1m-20230614-112833/DeepFM_ml1m-20230614-112833_model.ckpt
2023-06-14 11:31:54,398 P42753 INFO ***** Train/validation/test results *****
2023-06-14 11:32:00,756 P42753 INFO [Metrics] logloss: 0.251423 - AUC: 0.933343
2023-06-14 11:32:02,596 P42753 INFO [Metrics] logloss: 0.360934 - AUC: 0.890806
2023-06-14 11:32:04,406 P42753 INFO [Metrics] logloss: 0.360934 - AUC: 0.890806
