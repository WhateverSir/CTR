2023-06-14 11:37:21,731 P49509 INFO Start the demo...
2023-06-14 11:37:21,732 P49509 INFO {
    "model_id": "DeepFM",
    "dataset_id": "ml1m-20230614-113721",
    "train_data": "../data/Movielens1M/Movielens1M_x0/train.csv",
    "valid_data": "../data/Movielens1M/Movielens1M_x0/test.csv",
    "test_data": "../data/Movielens1M/Movielens1M_x0/test.csv",
    "model_dir": "../checkpoints/",
    "embedding_dim": "64",
    "embedding_regularizer": "0.01",
    "kernel_regularizer": "0",
    "hidden_units": "[500, 500, 500, 500]",
    "hidden_activations": "relu",
    "learning_rate": "0.001",
    "dropout_rates": "0",
    "batch_norm": "False",
    "optimizer": "adam",
    "task": "classification",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "10",
    "batch_size": "10000",
    "epochs": "50",
    "shuffle": "True",
    "seed": "2019",
    "monitor": "AUC",
    "monitor_mode": "max",
    "use_hdf5": "True",
    "patience": "2",
    "workers": "1",
    "verbose": "0",
    "version": "pytorch",
    "gpu": "0"
}
2023-06-14 11:37:21,732 P49509 INFO Set up feature encoder...
2023-06-14 11:37:21,732 P49509 INFO Reading file: ../data/Movielens1M/Movielens1M_x0/train.csv
2023-06-14 11:37:22,097 P49509 INFO Preprocess feature columns...
2023-06-14 11:37:22,246 P49509 INFO Fit feature encoder...
2023-06-14 11:37:22,560 P49509 INFO Setting feature index.
2023-06-14 11:37:22,560 P49509 INFO Set feature encoder done.
2023-06-14 11:37:22,563 P49509 INFO Pickle feature encode to file: ../checkpoints/ml1m-20230614-113721/feature_encoder.pkl
2023-06-14 11:37:22,571 P49509 INFO Loading data...
2023-06-14 11:37:22,572 P49509 INFO Reading file: ../data/Movielens1M/Movielens1M_x0/train.csv
2023-06-14 11:37:22,919 P49509 INFO Preprocess feature columns...
2023-06-14 11:37:23,052 P49509 INFO Transform feature encoder...
2023-06-14 11:37:23,508 P49509 INFO Saving data to ../checkpoints/ml1m-20230614-113721/train.hdf5
2023-06-14 11:37:23,542 P49509 INFO Reading file: ../data/Movielens1M/Movielens1M_x0/test.csv
2023-06-14 11:37:23,629 P49509 INFO Preprocess feature columns...
2023-06-14 11:37:23,658 P49509 INFO Transform feature encoder...
2023-06-14 11:37:23,749 P49509 INFO Saving data to ../checkpoints/ml1m-20230614-113721/test.hdf5
2023-06-14 11:37:23,761 P49509 INFO Train samples: total/589667 pos/466606 neg/123061 ratio/79.13%
2023-06-14 11:37:23,762 P49509 INFO Validation samples: total/147386 pos/107650 neg/39736 ratio/73.04%
2023-06-14 11:37:23,762 P49509 INFO Loading data from ../checkpoints/ml1m-20230614-113721/test.hdf5
2023-06-14 11:37:23,765 P49509 INFO Test samples: total/147386 pos/107650 neg/39736 ratio/73.04%
2023-06-14 11:37:23,765 P49509 INFO Loading data done.
2023-06-14 11:37:23,830 P49509 INFO **** Start training: 59 batches/epoch ****
2023-06-14 11:37:32,021 P49509 INFO [Metrics] logloss: 0.441860 - AUC: 0.836985
2023-06-14 11:37:32,023 P49509 INFO Save best model: monitor(max): 0.836985
2023-06-14 11:37:32,031 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:37:32,324 P49509 INFO Train loss: 0.458641
2023-06-14 11:37:32,325 P49509 INFO ************ Epoch=1 end ************
2023-06-14 11:37:41,944 P49509 INFO [Metrics] logloss: 0.404435 - AUC: 0.852785
2023-06-14 11:37:41,946 P49509 INFO Save best model: monitor(max): 0.852785
2023-06-14 11:37:41,955 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:37:42,123 P49509 INFO Train loss: 0.389086
2023-06-14 11:37:42,123 P49509 INFO ************ Epoch=2 end ************
2023-06-14 11:37:51,576 P49509 INFO [Metrics] logloss: 0.395360 - AUC: 0.860630
2023-06-14 11:37:51,578 P49509 INFO Save best model: monitor(max): 0.860630
2023-06-14 11:37:51,587 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:37:51,765 P49509 INFO Train loss: 0.377055
2023-06-14 11:37:51,765 P49509 INFO ************ Epoch=3 end ************
2023-06-14 11:38:01,320 P49509 INFO [Metrics] logloss: 0.387359 - AUC: 0.866524
2023-06-14 11:38:01,322 P49509 INFO Save best model: monitor(max): 0.866524
2023-06-14 11:38:01,332 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:38:01,502 P49509 INFO Train loss: 0.372056
2023-06-14 11:38:01,502 P49509 INFO ************ Epoch=4 end ************
2023-06-14 11:38:11,112 P49509 INFO [Metrics] logloss: 0.384418 - AUC: 0.872193
2023-06-14 11:38:11,114 P49509 INFO Save best model: monitor(max): 0.872193
2023-06-14 11:38:11,123 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:38:11,297 P49509 INFO Train loss: 0.366438
2023-06-14 11:38:11,297 P49509 INFO ************ Epoch=5 end ************
2023-06-14 11:38:21,088 P49509 INFO [Metrics] logloss: 0.380855 - AUC: 0.873341
2023-06-14 11:38:21,090 P49509 INFO Save best model: monitor(max): 0.873341
2023-06-14 11:38:21,100 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:38:21,276 P49509 INFO Train loss: 0.362629
2023-06-14 11:38:21,276 P49509 INFO ************ Epoch=6 end ************
2023-06-14 11:38:30,488 P49509 INFO [Metrics] logloss: 0.375422 - AUC: 0.876161
2023-06-14 11:38:30,490 P49509 INFO Save best model: monitor(max): 0.876161
2023-06-14 11:38:30,499 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:38:30,665 P49509 INFO Train loss: 0.359458
2023-06-14 11:38:30,666 P49509 INFO ************ Epoch=7 end ************
2023-06-14 11:38:39,806 P49509 INFO [Metrics] logloss: 0.372981 - AUC: 0.877818
2023-06-14 11:38:39,807 P49509 INFO Save best model: monitor(max): 0.877818
2023-06-14 11:38:39,816 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:38:39,996 P49509 INFO Train loss: 0.354794
2023-06-14 11:38:39,997 P49509 INFO ************ Epoch=8 end ************
2023-06-14 11:38:49,249 P49509 INFO [Metrics] logloss: 0.370397 - AUC: 0.880069
2023-06-14 11:38:49,252 P49509 INFO Save best model: monitor(max): 0.880069
2023-06-14 11:38:49,261 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:38:49,438 P49509 INFO Train loss: 0.352368
2023-06-14 11:38:49,438 P49509 INFO ************ Epoch=9 end ************
2023-06-14 11:38:58,650 P49509 INFO [Metrics] logloss: 0.367611 - AUC: 0.881396
2023-06-14 11:38:58,652 P49509 INFO Save best model: monitor(max): 0.881396
2023-06-14 11:38:58,661 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:38:58,841 P49509 INFO Train loss: 0.350533
2023-06-14 11:38:58,842 P49509 INFO ************ Epoch=10 end ************
2023-06-14 11:39:07,939 P49509 INFO [Metrics] logloss: 0.366890 - AUC: 0.881761
2023-06-14 11:39:07,941 P49509 INFO Save best model: monitor(max): 0.881761
2023-06-14 11:39:07,951 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:39:08,098 P49509 INFO Train loss: 0.349311
2023-06-14 11:39:08,098 P49509 INFO ************ Epoch=11 end ************
2023-06-14 11:39:17,316 P49509 INFO [Metrics] logloss: 0.366594 - AUC: 0.882647
2023-06-14 11:39:17,318 P49509 INFO Save best model: monitor(max): 0.882647
2023-06-14 11:39:17,327 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:39:17,492 P49509 INFO Train loss: 0.346858
2023-06-14 11:39:17,492 P49509 INFO ************ Epoch=12 end ************
2023-06-14 11:39:26,819 P49509 INFO [Metrics] logloss: 0.366268 - AUC: 0.883369
2023-06-14 11:39:26,821 P49509 INFO Save best model: monitor(max): 0.883369
2023-06-14 11:39:26,831 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:39:27,005 P49509 INFO Train loss: 0.345190
2023-06-14 11:39:27,006 P49509 INFO ************ Epoch=13 end ************
2023-06-14 11:39:36,923 P49509 INFO [Metrics] logloss: 0.364084 - AUC: 0.884181
2023-06-14 11:39:36,925 P49509 INFO Save best model: monitor(max): 0.884181
2023-06-14 11:39:36,934 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:39:37,106 P49509 INFO Train loss: 0.343706
2023-06-14 11:39:37,106 P49509 INFO ************ Epoch=14 end ************
2023-06-14 11:39:46,320 P49509 INFO [Metrics] logloss: 0.362665 - AUC: 0.884764
2023-06-14 11:39:46,322 P49509 INFO Save best model: monitor(max): 0.884764
2023-06-14 11:39:46,331 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:39:46,695 P49509 INFO Train loss: 0.340942
2023-06-14 11:39:46,696 P49509 INFO ************ Epoch=15 end ************
2023-06-14 11:39:56,403 P49509 INFO [Metrics] logloss: 0.364194 - AUC: 0.885059
2023-06-14 11:39:56,405 P49509 INFO Save best model: monitor(max): 0.885059
2023-06-14 11:39:56,415 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:39:56,607 P49509 INFO Train loss: 0.340394
2023-06-14 11:39:56,608 P49509 INFO ************ Epoch=16 end ************
2023-06-14 11:40:05,798 P49509 INFO [Metrics] logloss: 0.365333 - AUC: 0.884508
2023-06-14 11:40:05,799 P49509 INFO Monitor(max) STOP: 0.884508 !
2023-06-14 11:40:05,800 P49509 INFO Reduce learning rate on plateau: 0.000100
2023-06-14 11:40:05,800 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:40:05,975 P49509 INFO Train loss: 0.337901
2023-06-14 11:40:05,976 P49509 INFO ************ Epoch=17 end ************
2023-06-14 11:40:15,470 P49509 INFO [Metrics] logloss: 0.360230 - AUC: 0.889892
2023-06-14 11:40:15,472 P49509 INFO Save best model: monitor(max): 0.889892
2023-06-14 11:40:15,481 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:40:15,677 P49509 INFO Train loss: 0.307147
2023-06-14 11:40:15,678 P49509 INFO ************ Epoch=18 end ************
2023-06-14 11:40:24,914 P49509 INFO [Metrics] logloss: 0.360934 - AUC: 0.890806
2023-06-14 11:40:24,916 P49509 INFO Save best model: monitor(max): 0.890806
2023-06-14 11:40:24,925 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:40:25,106 P49509 INFO Train loss: 0.291292
2023-06-14 11:40:25,106 P49509 INFO ************ Epoch=19 end ************
2023-06-14 11:40:34,711 P49509 INFO [Metrics] logloss: 0.362254 - AUC: 0.889795
2023-06-14 11:40:34,713 P49509 INFO Monitor(max) STOP: 0.889795 !
2023-06-14 11:40:34,713 P49509 INFO Reduce learning rate on plateau: 0.000010
2023-06-14 11:40:34,713 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:40:34,889 P49509 INFO Train loss: 0.283499
2023-06-14 11:40:34,890 P49509 INFO ************ Epoch=20 end ************
2023-06-14 11:40:44,128 P49509 INFO [Metrics] logloss: 0.368506 - AUC: 0.889843
2023-06-14 11:40:44,130 P49509 INFO Monitor(max) STOP: 0.889843 !
2023-06-14 11:40:44,130 P49509 INFO Reduce learning rate on plateau: 0.000001
2023-06-14 11:40:44,130 P49509 INFO Early stopping at epoch=20.98
2023-06-14 11:40:44,130 P49509 INFO --- 59/59 batches finished ---
2023-06-14 11:40:44,191 P49509 INFO Train loss: 0.265797
2023-06-14 11:40:44,192 P49509 INFO Training finished.
2023-06-14 11:40:44,192 P49509 INFO Load best model: /workspace/sophon-demo/sample/CTR/checkpoints/ml1m-20230614-113721/DeepFM_ml1m-20230614-113721_model.ckpt
2023-06-14 11:40:44,209 P49509 INFO ***** Train/validation/test results *****
2023-06-14 11:40:50,868 P49509 INFO [Metrics] logloss: 0.251423 - AUC: 0.933343
2023-06-14 11:40:52,733 P49509 INFO [Metrics] logloss: 0.360934 - AUC: 0.890806
2023-06-14 11:40:54,574 P49509 INFO [Metrics] logloss: 0.360934 - AUC: 0.890806
